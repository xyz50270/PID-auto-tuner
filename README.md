# PID 迭代整定与智能诊断系统 (PID-auto-tuner)

这是一个专为工业控制系统设计的 PID 参数迭代整定与回路健康诊断辅助工具。它通过分析历史运行数据，利用系统辨识技术自动提取物理模型，并基于安全增量原则推荐优化的 PID 参数。

## 核心功能

*   **📈 迭代整定工作流**：支持“基准数据上传 -> 模型辨识 -> 获取建议 -> 效果验证”的闭环迭代过程。
*   **🚀 过程辨识 (FOPDT)**：自动拟合一阶加纯滞后（First-Order Plus Dead-Time）模型，获取增益 (K)、时间常数 (τ) 和滞后时间 (θ)。
*   **🩺 智能健康诊断**：检测控制回路中的震荡、执行器饱和、异常噪音等健康问题。
*   **💡 安全整定建议**：基于 SIMC 等先进整定算法，并引入“安全步长”限制（默认单次调整不超过 20%），确保工业现场安全。
*   **🔮 闭环仿真对比**：在应用参数前，直观对比当前参数与建议参数的理论响应曲线。
*   **📊 多维度性能评价**：量化分析 IAE（绝对误差积分）、TV（输出总变差）、超调量及调节时间等关键 KPI。
*   **🔄 参数模式切换**：支持“比例增益 (Kp)”与“比例度 (PB)”一键切换，适配不同行业工程师的使用习惯。
*   **💾 会话进度管理**：支持整定过程的导出与导入，方便跨时间、跨人员协作。

## 技术栈

*   **语言**: Python 3.10+ (支持 Windows 免安装内嵌环境)
*   **Web 框架**: [Streamlit](https://streamlit.io/) (交互式 UI)
*   **数据处理**: Pandas, NumPy
*   **科学计算**: SciPy (非线性优化与信号处理)
*   **可视化**: Plotly (动态交互图表)

## 快速开始 (Windows)

本项目已针对 Windows 平台进行了优化，无需手动安装 Python 环境。

### 1. 初始化环境 (首次运行)
右键点击 `setup_runtime.ps1` 并选择“使用 PowerShell 运行”，或者在终端执行：
```powershell
.\setup_runtime.ps1
```
该脚本会自动下载内嵌式 Python 运行时并安装所有必要的依赖包到 `runtime/` 目录。

### 2. 启动程序
双击根目录下的 **`run.bat`** 即可启动系统。

---

## 快速开始 (传统方式/其他平台)
如果你希望使用系统自带的 Python 环境：

## 数据要求

上传的 CSV 或 Excel (XLSX/XLS) 数据文件需包含以下关键列（支持不分大小写的模糊匹配）：

*   **Time**: 完整的日期时间格式（例如 `2025-12-24 10:00:00`）。**推荐使用 Excel 格式以确保秒级时间精度不会丢失。**
*   **SP (SetPoint)**: 设定值 / 目标值。
*   **PV (Process Variable)**: 过程变量 / 测量值。
*   **OP (Output)**: 控制器输出值（通常为 0-100%）。

### 数据模板
您可以下载并参考项目根目录下的 [template.csv](./template.csv) 文件。

## 使用步骤

1.  **上传基准数据**：在侧边栏录入当前运行的 PID 参数并上传一段 CSV 历史数据。
2.  **回路诊断**：在“诊断与模型辨识”标签页查看回路是否健康。
3.  **辨识模型**：点击“辨识此阶段物理模型”，系统将自动计算对象的数学模型。
4.  **获取建议**：根据您的整定偏好（保守/适中/激进），获取下一步建议的 PID 参数。
5.  **循环优化**：在控制器中应用新参数后，采集新一段数据并再次上传，系统将根据实际反馈不断修正整定建议。

---
**⚠️ 安全声明**：工业现场安全第一。本工具提供的所有参数建议仅作为工程参考，在实际应用前请务必经过专业工程师的审核。

*注：当前版本界面带有“开发测试版”水印，仅用于内部测试与评估。*
